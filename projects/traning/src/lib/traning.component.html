<mat-card class="main-mat-card admingeneralcls">
    <span class="searchblock">
        <span class="searchblockwrapper" style="display: inline;">
            <span>
                <h1 class="header">{{ headerText     }}</h1>
            </span>
        </span>
    </span>
    <form novalidate (ngSubmit)="formsubmit()" class="formclass">
        <ng-container [formGroup]="dataForm" *ngFor="let item of formdataval; let i=index;">

            <div *ngIf="item.inputtype == 'text'">
                <mat-label *ngIf="item.inputtype == 'text'">{{item.label}} : </mat-label>

                <mat-form-field *ngIf="item.inputtype == 'text' || item.inputtype == 'password'">
                    <input matInput [type]="item.inputtype" [placeholder]="item.placeholder"
                        [formControlName]="[item.name]" (keyup)="issubmit=0">

                    <mat-error
                        *ngIf="dataForm.controls[item.name]!=null &&  item.validationrule!=null && !dataForm.controls[item.name].valid && dataForm.controls[item.name].touched && issubmit==1">
                        {{item.label}}

                        {{item.validationerrormsg}}</mat-error>
                </mat-form-field>
            </div>

            <div *ngIf="item.inputtype == 'textarea'">
                <mat-label *ngIf="item.inputtype == 'textarea'">{{item.label}} : </mat-label>

                <mat-form-field *ngIf="item.inputtype == 'textarea'">
                    <textarea matInput [placeholder]="item.placeholder" [formControlName]="[item.name]"
                        (keyup)="issubmit=0"></textarea>
                    <mat-error
                        *ngIf="dataForm.controls[item.name]!=null &&  item.validationrule!=null && !dataForm.controls[item.name].valid && dataForm.controls[item.name].touched && issubmit==1">
                        {{item.label}}

                        {{item.validationerrormsg}}</mat-error>
                </mat-form-field>
            </div>

            <div *ngIf="item.inputtype == 'email'">
                <mat-form-field *ngIf="item.inputtype == 'email'">
                    <input matInput pattern="[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,3}$" [name]="item.name"
                        [type]="item.inputtype" [placeholder]="item.placeholder" [formControlName]="[item.name]"
                        (keyup)="issubmit=0">
                    <mat-error
                        *ngIf="dataForm.controls[item.name]!=null &&  item.validationrule!=null && !dataForm.controls[item.name].valid && dataForm.controls[item.name].touched && issubmit==1">
                        {{item.label}}
                        {{item.validationerrormsg}}</mat-error>
                </mat-form-field>
            </div>

            <div *ngIf="item.inputtype == 'url'">
                <mat-form-field *ngIf="item.inputtype == 'url'">
                    <input matInput
                        pattern="^(http:\/\/www\.|https:\/\/www\.|http:\/\/|https:\/\/)?[a-z0-9]+([\-\.]{1}[a-z0-9]+)*\.[a-z]{2,5}(:[0-9]{1,5})?(\/.*)?|^((http:\/\/www\.|https:\/\/www\.|http:\/\/|https:\/\/)?([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])$"
                        [name]="item.name" [type]="item.inputtype" [placeholder]="item.placeholder"
                        [formControlName]="[item.name]" (keyup)="issubmit=0">

                    <mat-error
                        *ngIf="dataForm.controls[item.name]!=null &&  item.validationrule!=null && !dataForm.controls[item.name].valid && dataForm.controls[item.name].touched && issubmit==1">
                        {{item.label}}
                        {{item.validationerrormsg}}</mat-error>
                </mat-form-field>
            </div>

            <div class="checkboxnew" *ngIf="item.inputtype =='checkbox'">
                <mat-label *ngIf="item.inputtype =='checkbox'">{{item.label}}:</mat-label>
                <mat-checkbox *ngIf="item.inputtype == 'checkbox'" [ngClass]="item.class"
                    [formControlName]="[item.name]" (keyup)="issubmit=0" [(ngModel)]="checked"></mat-checkbox>
            </div><br>



            <div *ngIf="item.inputtype =='radio'">
                <span *ngIf="item.inputtype =='radio'">
                    <mat-label *ngIf="item.inputtype=='radio'">{{item.label}}:</mat-label>
                    <mat-radio-group [formControlName]="[item.name]">
                        <mat-radio-button type="radio" *ngFor="let val of item.value" [name]="item.name" [value]="val"
                            (keyup)="issubmit=0" [ngClass]="item.class">{{val}} {{item.valuelabel}}</mat-radio-button>
                    </mat-radio-group>
                </span>
            </div>

            <div *ngIf="item.inputtype == 'select'">
                <!-- <mat-label *ngIf="item.inputtype == 'select'">{{item.label}}:</mat-label> -->
                <mat-form-field *ngIf="item.inputtype == 'select'">
                    <span *ngIf="item.multiple!=true">
                        <mat-select [placeholder]="item.defaultchoice" [formControlName]="item.name"
                            (selectionChange)="getMediaTypeVal($event.value,item.name);" value="">
                            <mat-option value="" selected>{{item.defaultchoice}}</mat-option>
                            <mat-option *ngFor="let selectval of item.sourceval" value="{{selectval[item.selectid]}}"
                                (keyup)="issubmit=0">
                                {{selectval[item.selectvalue]}}</mat-option>
                        </mat-select>
                    </span>


                    <span *ngIf="item.multiple==true">
                        <mat-select [placeholder]="item.defaultchoice" [formControlName]="item.name"
                            (selectionChange)="getMediaTypeVal($event.value,item.name);" value="" multiple>
                            <!-- <mat-option value="" selected>{{item.defaultchoice}}</mat-option> -->
                            <mat-option *ngFor="let selectval of item.sourceval" value="{{selectval[item.selectid]}}"
                                (keyup)="issubmit=0">
                                {{selectval[item.selectvalue]}}</mat-option>
                        </mat-select>
                    </span>
                    <mat-error
                        *ngIf="dataForm.controls[item.name]!=null &&  item.validationrule!=null && !dataForm.controls[item.name].valid && dataForm.controls[item.name].touched && issubmit==1">
                        {{item.label}}
                        {{item.validationerrormsg}}</mat-error>
                </mat-form-field>

            </div>


            <div *ngIf="item.inputtype == 'button' && item.buttonflag == true" style="display: inline;">
                <div *ngFor="let i of item.sourceval">
                    <div class="typebtncls">
                        <button type="button" mat-raised-button color="primary" (click)="openTrainingType(i)">Add
                            {{i.name}} </button>
                    </div>
                </div>
            </div>


            <mat-progress-bar *ngIf="progressLoader && item.name =='associated_training'" mode="indeterminate">
            </mat-progress-bar>
        </ng-container>



        <div>

            <button type="button" mat-raised-button color="primary" (click)="addfile()">add
               file by modal </button>



            <div *ngIf="fileflag == true && file_array.length > 0" class='fromClass'>
                <div class="addfilecls">
                    <mat-label><b> Files : </b></mat-label>
                    <span class="adddeletecls">
                        <i class="material-icons addbtn" (click)="addflie()">add_box</i>
                    </span>
                </div>


                <div *ngFor="let item of file_array; let i=index;trackBy: trackByFn" class="fromClass addvideoblock">

                    <!-- <lib-file-upload [config]='uploadConfigData'></lib-file-upload> -->

                    <mat-card class="example-card imgcard"
                        *ngIf="file_array[i].file != null && file_array[i].file.fileservername !=null">



                        <span>
                            <img mat-card-image [attr.src]="bucket_url + file_array[i].file.fileservername">
                        </span>



                        <mat-card-title>{{ file_array[i].file.fileservername }}</mat-card-title>
                        <span class="closecard" (click)="clear_file('file_array',i)"><i
                                class="material-icons">clear</i></span>
                    </mat-card>


                    <button type="button" mat-raised-button color="primary" (click)="doneFileUpload('file_array',i)">Add
                        Uploaded File</button><br>

                    <mat-form-field>
                        <input type="text" matInput placeholder="File Title" [(ngModel)]=file_array[i].file_title
                            [ngModelOptions]="{standalone: true}">
                        <mat-icon matSuffix>File Title</mat-icon>
                    </mat-form-field>

                    <mat-form-field>
                        <textarea type="text" matInput placeholder="File Description"
                            [(ngModel)]=file_array[i].file_description [ngModelOptions]="{standalone: true}"></textarea>
                        <mat-icon matSuffix>File Description</mat-icon>
                    </mat-form-field>
                    <mat-form-field>
                        <input type="number" matInput placeholder="Priority" [(ngModel)]=file_array[i].file_priority
                            [ngModelOptions]="{standalone: true}">
                        <mat-icon matSuffix>File Priority</mat-icon>
                    </mat-form-field>
                    <section class="example-section">
                        <mat-checkbox matInput [(ngModel)]="file_array[i].file_skippable"
                            [ngModelOptions]="{standalone: true}">Skippable file
                        </mat-checkbox>
                    </section>

                    <span class="adddeletecls">
                        <i class="material-icons addbtn" (click)="addflie()">add_box</i>
                        <i class="material-icons delbtn" (click)="removefile(i)">delete</i>
                    </span>
                </div>


            </div>



            <div *ngIf="audioflag == true && audio_array.length > 0" class="fromClass">
                <mat-label><b> Audio : </b></mat-label>
                <!-- <span class="adddeletecls">
                    <i class="material-icons addbtn" (click)="addAudio()">add_box</i>
                </span> -->

                <div *ngFor="let item of audio_array; let i=index;trackBy: trackByFn" class="fromClass addvideoblock">

                    <!-- <lib-file-upload [config]="uploadConfigData"></lib-file-upload> -->

                    <mat-card class="example-card imgcard"
                        *ngIf="audio_array[i].audio != null && audio_array[i].audio.fileservername !=null">


                        <audio controls>

                            <source src="{{bucket_url + audio_array[i].audio.fileservername }}" type="audio/ogg">
                            <source src="{{ bucket_url + audio_array[i].audio.fileservername }}" type="audio/mpeg">
                            Your browser does not support the audio element.
                        </audio>

                        <mat-card-title>{{ audio_array[i].audio.fileservername }}</mat-card-title>
                        <!-- <mat-card-subtitle>{{ audio_array[i].audio.type }}</mat-card-subtitle> -->
                        <span class="closecard" (click)="clear_file('audio_array',i)"><i
                                class="material-icons">clear</i></span>
                    </mat-card>

                    <button type="button" mat-raised-button color="primary"
                        (click)="doneAudioupload('audio_array',i)">Add Uploaded Audio</button><br>
                    <mat-form-field>
                        <input type="text" matInput placeholder="Audio Title" [(ngModel)]=audio_array[i].audio_title
                            [ngModelOptions]="{standalone: true}">
                        <mat-icon matSuffix>Audio Title</mat-icon>
                    </mat-form-field>

                    <mat-form-field>
                        <textarea type="text" matInput placeholder="Audio Description"
                            [(ngModel)]="audio_array[i].audio_description"
                            [ngModelOptions]="{standalone: true}"></textarea>
                        <mat-icon matSuffix>Audio Description</mat-icon>
                    </mat-form-field>

                    <mat-form-field>
                        <input type="number" matInput placeholder="Priority" [(ngModel)]=audio_array[i].audio_priority
                            [ngModelOptions]="{standalone: true}">
                        <mat-icon matSuffix>Audio Priority</mat-icon>
                    </mat-form-field>
                    <section class="example-section">
                        <mat-checkbox matInput [(ngModel)]="audio_array[i].audio_skippable"
                            [ngModelOptions]="{standalone: true}">Skippable Audio
                        </mat-checkbox>
                    </section>
                    <span class="adddeletecls">
                        <i class="material-icons addbtn" (click)="addAudio()">add_box</i>
                        <i class="material-icons delbtn" (click)="removeaudio(i)">delete</i>
                    </span><br>

                </div>
            </div>
            <!-- <ng-container *ngIf="mediaTypeValue == 'audio' && imagePath != null && audioVideoFlag==true">

                    <div style="margin: 0 auto;display: block;">
                        <mat-card class="example-card">
                            <span class="closecard" class="pointer" *ngIf="mediaTypeValue == 'audio'"
                                (click)="clear()"><i class="material-icons">clear</i></span>
                            <audio controls>

                                <source src="{{ imagePath }}" type="audio/ogg">
                                <source src="{{ imagePath }}" type="audio/mpeg">
                                Your browser does not support the audio element.
                            </audio>
                        </mat-card>
                    </div>
                </ng-container> -->



            <!-- <div *ngIf="htmlflag == true">
                <h4>Add HTML :</h4>
                <ck-editor [config]="editorconfig" [(ngModel)]="htmType" [ngModelOptions]="{standalone: true}">
                </ck-editor>
            </div> -->



            <div *ngIf="videoflag == true && video_array.length > 0" class="fromClass">
                <div class="addvideocls">
                    <mat-label><b> Videos : </b></mat-label>
                    <span class="adddeletecls">
                        <i class="material-icons addbtn" (click)="addVideo()">add_box</i>
                    </span>
                </div>

                <div *ngFor="let item of video_array; let i=index;trackBy: trackByFn" class="fromClass addvideoblock">
                    <ng-container>
                        <mat-form-field>
                            <span matPrefix>https://www.youtube.com/watch?v= &nbsp;</span>
                            <input matInput placeholder="Enter Video ID" [(ngModel)]="video_array[i].video_url"
                                [ngModelOptions]="{standalone: true}">
                            <mat-icon matSuffix class="clickable" (click)="preview_video(video_array[i].video_url)">
                                remove_red_eye</mat-icon>
                        </mat-form-field> <br>

                        <mat-form-field>
                            <input matInput placeholder="Video Title" [(ngModel)]="video_array[i].video_title"
                                [ngModelOptions]="{standalone: true}">
                        </mat-form-field><br>

                        <mat-form-field>
                            <textarea matInput placeholder="Video Description"
                                [(ngModel)]="video_array[i].video_description"
                                [ngModelOptions]="{standalone: true}"></textarea>
                        </mat-form-field>



                        <!-- Is this mandatory video? -->
                        <mat-form-field>
                            <input type="number" matInput placeholder="Priority"
                                [(ngModel)]=video_array[i].video_priority [ngModelOptions]="{standalone: true}">
                            <mat-icon matSuffix>Video Priority</mat-icon>
                        </mat-form-field>
                        <section class="example-section">
                            <mat-checkbox matInput [(ngModel)]="video_array[i].video_skippable"
                                [ngModelOptions]="{standalone: true}">Skippable video ?
                            </mat-checkbox>
                        </section><br>
                        <span class="adddeletecls">
                            <i class="material-icons addbtn" (click)="addVideo()">add_box</i>
                            <i class="material-icons delbtn" (click)="removevideo(i)">delete</i>
                        </span>
                    </ng-container>

                </div>


                <!-- <div formArrayName="video_array"
                    *ngFor="let item of video_array; let i=index ;trackBy: trackByFn"
                    class="fromClass">
                    <ng-container [formGroupName]="i">
                        <mat-form-field >
                            <input matInput formControlName="answer" placeholder="Answer">
                            <span matSuffix>
                                <i class="material-icons" (click)="addAnswer('')">add</i>
                                <i *ngIf="i>0" class="material-icons" (click)="removeAnswer(i)">remove</i>
                            </span>
                        </mat-form-field>
                    </ng-container>
                </div> -->
            </div>



            <!-- <mat-form-field>
                <input type="text" matInput placeholder="Title" [(ngModel)]="title"
                    [ngModelOptions]="{standalone: true}">
                <mat-icon matSuffix>title</mat-icon>
            </mat-form-field>

            <mat-form-field>
                <textarea type="text" matInput placeholder="Description" [(ngModel)]="description"
                    [ngModelOptions]="{standalone: true}"></textarea>
                <mat-icon matSuffix>description</mat-icon>
            </mat-form-field> -->


            <!-- file uploader end here -->

            <ng-container *ngIf="mediaTypeValue == 'image' && imagePath != null ">
                <mat-card class="example-card">
                    <span class="closecard" class="pointer" *ngIf="mediaTypeValue == 'image'" (click)="clear()"><i
                            class="material-icons">clear</i></span>
                    <img mat-card-image src="{{ imagePath }}" />
                </mat-card>
            </ng-container>

            <!-- <ng-container *ngIf="mediaTypeValue == 'video' && imagePath != null && audioVideoFlag==true">
                <div style="margin: 0 auto;display: block;">
                    <mat-card class="example-card">
                        <span class="closecard" class="pointer" *ngIf="mediaTypeValue == 'video'" (click)="clear()"><i
                                class="material-icons">clear</i></span>
                        <video width="640" height="360" controls>
                            <source src="{{ imagePath }}" type="video/mp4">
                            Your browser does not support the video tag.
                        </video>
                    </mat-card>
                </div>

            </ng-container> -->

        </div>


        <div>
            <mat-label><b> HTML Content : </b></mat-label>
            <ck-editor [config]="editorconfig" [(ngModel)]="htmType" [ngModelOptions]="{standalone: true}">
            </ck-editor>
        </div>


        <ng-container *ngIf="dnaFlag==true">

            <div>
                <span>
                    <mat-checkbox [(ngModel)]="has_test_lesson" [ngModelOptions]="{standalone: true}">Has Test Lesson ?
                    </mat-checkbox>

                    <div *ngIf="has_test_lesson == true">
                        <mat-form-field>
                            <input type="number" matInput placeholder="Enter Complete Test Percentage (%)"
                                [(ngModel)]="test_percentage" [ngModelOptions]="{standalone: true}">
                        </mat-form-field>
                    </div>

                </span>
            </div>
            <!-- <div>
                <span>
                    <mat-checkbox [(ngModel)]="has_test_lesson" [ngModelOptions]="{standalone: true}"> Skip Lesson ?
                    </mat-checkbox>
                </span>
            </div> -->
            <div>
                <span>
                    <mat-checkbox (change)="getchkboxval($event.checked)" [(ngModel)]="chkboxval"
                        [ngModelOptions]="{standalone: true}">Has Lesson plan?</mat-checkbox>
                </span>
            </div>

            <div *ngIf="hasLessonVal == true">
                <mat-form-field>
                    <mat-label>Select A One</mat-label>
                    <mat-select [(ngModel)]="lessonplanValue" [ngModelOptions]="{standalone: true}">
                        <mat-option value="purchasable">Purchasable </mat-option>
                        <mat-option value="not_purchasable">Not Purchasable </mat-option>
                    </mat-select>
                </mat-form-field>
            </div>


        </ng-container>


        <button class="trainingsubbtn" mat-raised-button color="primary" type="submit">{{ buttonText }}</button>
        <button class="trainingsubbtn" mat-raised-button color="primary" type="reset"
            (click)="cancelButton()">Cancel</button>
    </form>
</mat-card>